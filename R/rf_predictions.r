#' Extract predictions from a random forest model
#'
#' @param caret.rf A randomForest model generated by caret
#' @param yvals Feature in the experimental design data frame to use as data labels
#'
#' @return rf.predict A vector of predictions from the randomForest model
#' @export
#'
rf_predictions <- function(caret.rf, yvals){
  # Extract the final forest
  caret.forest <- caret.rf$finalModel
  # Generate predictions and tidy
  rf.call <- broom::tidy(predict(caret.forest))
  rf.probs <- broom::tidy(predict(caret.forest, type="prob"))
  rf.predict <- dplyr::bind_cols(rf.call, rf.probs)
  rf.predict <- rf.predict %>%
    dplyr::mutate(rna_seq_lib = .rownames,
           prediction = as.factor(x)) %>%
    dplyr::select(-x, -.rownames)
  return(rf.predict)
}
